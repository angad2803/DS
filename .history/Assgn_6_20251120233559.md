# Assignment 6: Data Manipulation with dplyr

**SURYA KANT TIWARI**  
**102303737 (3C52)**

---

## Question 1: Create Dataset and Perform dplyr Operations

### Setup and Data Creation

```r
# Install and load required package
install.packages("dplyr")
library(dplyr)

# Set seed for reproducibility
set.seed(123)

# Define data parameters
years <- 2000:2019
countries <- c("India", "USA", "CHINA", "Brazil", "Germany",
               "France", "UK", "Canada", "Australia", "Russia")
continents <- c("Asia", "North America", "South America", "Europe", "Australia")

# Create dataset with 100 observations
DATASET <- data.frame(
  Country = sample(countries, 100, replace = TRUE),
  Continent = sample(continents, 100, replace = TRUE),
  Year = sample(years, 100, replace = TRUE),
  LifeExp = round(runif(100, 50, 85), 1),
  Pop = sample(1e6:1e7, 100, replace = TRUE),
  GdpPerc = round(runif(100, 1000, 50000), 2)
)
```

---

### 1.1 Count Unique Countries per Continent

```r
DATASET %>%
  group_by(Continent) %>%
  summarise(UniqueCountries = n_distinct(Country))
```

---

### 1.2 Find Lowest GDP per Capita in Europe for Year 2010

```r
year_query <- 2010

DATASET %>%
  filter(Continent == "Europe", Year == year_query) %>%
  arrange(GdpPerc) %>%
  slice(1)
```

---

### 1.3 Calculate Average Life Expectancy by Continent for a Given Year

```r
DATASET %>%
  filter(Year == year_query) %>%
  group_by(Continent) %>%
  summarise(AverageLifeExp = mean(LifeExp))
```

---

### 1.4 Top 5 Countries with Highest Total GDP

```r
DATASET %>%
  group_by(Country) %>%
  summarise(TotalGdp = sum(GdpPerc * Pop)) %>%
  arrange(desc(TotalGdp)) %>%
  slice(1:5)
```

---

### 1.5 Countries and Years with Life Expectancy â‰¥ 80

```r
DATASET %>%
  filter(LifeExp >= 80) %>%
  select(Country, Year, LifeExp)
```

---

### 1.6 Top 10 Countries with Strongest Correlation (LifeExp & GdpPerc)

```r
DATASET %>%
  group_by(Country) %>%
  summarise(Correlation = cor(LifeExp, GdpPerc)) %>%
  arrange(desc(abs(Correlation))) %>%
  slice(1:10)
```

---

### 1.7 Highest Average Population Outside Asia

```r
DATASET %>%
  filter(Continent != "Asia") %>%
  group_by(Year, Continent) %>%
  summarise(AvgPopulation = mean(Pop)) %>%
  arrange(desc(AvgPopulation))
```

---

### 1.8 Three Countries with Most Consistent Populations (Lowest SD)

```r
DATASET %>%
  group_by(Country) %>%
  summarise(PopulationSD = sd(Pop)) %>%
  arrange(PopulationSD) %>%
  slice(1:3)
```

---

### 1.9 Countries Where Population Decreased BUT Life Expectancy Increased

```r
exclude_year <- 2015

DATASET %>%
  arrange(Country, Year) %>%
  group_by(Country) %>%
  filter(Year != exclude_year) %>%
  mutate(
    Pop_Change = Pop - lag(Pop),
    LifeExp_Change = LifeExp - lag(LifeExp)
  ) %>%
  filter(Pop_Change < 0 & LifeExp_Change > 0)
```

---

## Question 2: Medicine Dataset Analysis

### Create and Save Medicine Dataset

```r
set.seed(67)

medicine_data <- data.frame(
  MedID = 1:10,
  Med_Name = c("Paracetamol", "Ibuprofen", "Amoxicillin", "Cetirizine",
               "Azithromycin", "Metformin", "Atorvastatin", "Omeprazole",
               "Amlodipine", "Simvastatin"),
  Company = c("PharmaA", "PharmaB", "PharmaC", "PharmaD", "PharmaE",
              "PharmaF", "PharmaG", "PharmaH", "PharmaI", "PharmaJ"),
  Manf_year = sample(2015:2023, 10, replace = TRUE),
  Exp_date = sample(2016:2028, 10, replace = TRUE),
  Quantity_in_stock = sample(50:500, 10, replace = TRUE),
  Sales = sample(100:1000, 10, replace = TRUE)
)

# Save to CSV file
write.csv(medicine_data, "DataSet.csv", row.names = FALSE)

# Read the CSV file
medicine_df <- read.csv("DataSet.csv")
```

---

### Display First 4 and Last 4 Records

```r
head(medicine_df, 4)
tail(medicine_df, 4)
```

---

### Correlation Between Quantity in Stock and Expiry Date

```r
correlation <- cor(medicine_df$Quantity_in_stock, medicine_df$Exp_date)
print(correlation)
```

---

### Barplot: Sales vs Manufacturing Year (ggplot2)

```r
library(ggplot2)

ggplot(medicine_df, aes(x = factor(Manf_year), y = Sales)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  xlab("Manufacturing Year") +
  ylab("Sales") +
  ggtitle("Sales vs Manufacturing Year")
```

---

### Find Companies with More Than One Medicine

```r
medicine_df %>%
  group_by(Company) %>%
  summarise(MedicineCount = n()) %>%
  filter(MedicineCount > 1)
```

---

### List All Types of Medicines Available

```r
unique(medicine_df$Med_Name)
```

---

### Boxplot of Expiry Dates

```r
boxplot(medicine_df$Exp_date,
        main = "Expiry Dates",
        ylab = "Expiry Year",
        col = "lightgreen")
```

---

### Calculate Average Stock

```r
avg_stock <- mean(medicine_df$Quantity_in_stock)
print(avg_stock)
```

---

### Regression Line: Manufacturing Year vs Sales

```r
# Create scatter plot
plot(medicine_df$Manf_year, medicine_df$Sales,
     xlab = "Manufacturing Year",
     ylab = "Sales",
     main = "Sales vs Manufacturing Year")

# Add regression line
abline(lm(Sales ~ Manf_year, data = medicine_df), col = "red")
```
