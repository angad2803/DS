# -----------------------------------------------

# UCS 548 – Foundations of Data Science

# Assignment 5 – Data Cleaning in R

# -----------------------------------------------

library(dplyr)

# ------------------------------------------------

# Q1. Read the CSV file & print first 10 records

# ------------------------------------------------

url <- "https://raw.githubusercontent.com/fivethirtyeight/data/master/daily-show-guests/daily_show_guests.csv"
df <- read.csv(url)

head(df, 10)

# ------------------------------------------------

# Q2. Display column names & rename the columns

# year → YEAR

# job → GoogleKnowlege_Occupation

# date → Show

# category → Group

# guest_name → Raw_Guest_List

# ------------------------------------------------

colnames(df)

df <- df %>%
rename(
YEAR = year,
GoogleKnowlege_Occupation = job,
Show = date,
Group = category,
Raw_Guest_List = guest_name
)

head(df)

# ------------------------------------------------

# Q3. Create a report having YEAR, Show, Raw_Guest_List

# ------------------------------------------------

report <- df %>%
select(YEAR, Show, Raw_Guest_List)

head(report)

# ------------------------------------------------

# Q4. Use select() to print all records EXCEPT YEAR

# ------------------------------------------------

df_without_year <- df %>%
select(-YEAR)

head(df_without_year)

# ------------------------------------------------

# Assignment 5: Data Cleaning in R

**UCS 548 – Foundations of Data Science**

---

## Setup

```r
library(dplyr)
```

---

## Question 1: Read CSV File and Print First 10 Records

```r
# Load data from FiveThirtyEight GitHub repository
url <- "https://raw.githubusercontent.com/fivethirtyeight/data/master/daily-show-guests/daily_show_guests.csv"
df <- read.csv(url)

# Display first 10 records
head(df, 10)
```

---

## Question 2: Display Column Names and Rename Columns

### Column Renaming Schema:

- `year` → `YEAR`
- `job` → `GoogleKnowlege_Occupation`
- `date` → `Show`
- `category` → `Group`
- `guest_name` → `Raw_Guest_List`

```r
# Display original column names
colnames(df)

# Rename columns
df <- df %>%
  rename(
    YEAR = year,
    GoogleKnowlege_Occupation = job,
    Show = date,
    Group = category,
    Raw_Guest_List = guest_name
  )

# Display updated dataframe
head(df)
```

---

## Question 3: Create Report with Selected Columns

Create a report containing only YEAR, Show, and Raw_Guest_List columns.

```r
report <- df %>%
  select(YEAR, Show, Raw_Guest_List)

head(report)
```

---

## Question 4: Select All Records EXCEPT YEAR Column

```r
df_without_year <- df %>%
  select(-YEAR)

head(df_without_year)
```

---

## Question 5: Filter Records by Occupation and Name

Extract list of people who are "actor" and have the name "ABC".

```r
actor_ABC <- df %>%
  filter(
    GoogleKnowlege_Occupation == "actor" &
    Raw_Guest_List == "ABC"
  )

print(actor_ABC)
```

---

## Question 6: Arrange Records by Show Date

```r
df_sorted <- df %>%
  arrange(Show)

head(df_sorted)
```

---

## Question 7: Add New Column "Experience" Using mutate()

Calculate Experience as the number of years since 1990.

```r
df <- df %>%
  mutate(Experience = YEAR - 1990)

head(df)
```

# ------------------------------------------------

actor_ABC <- df %>%
filter(GoogleKnowlege_Occupation == "actor" &
Raw_Guest_List == "ABC")

actor_ABC

# ------------------------------------------------

# Q6. Arrange records in order of Show (date)

# ------------------------------------------------

df_sorted <- df %>%
arrange(Show)

head(df_sorted)

# ------------------------------------------------

# Q7. Add a new column “Experience” using mutate()

# Experience = YEAR - 1990 (example formula)

# ------------------------------------------------

df <- df %>%
mutate(Experience = YEAR - 1990)

head(df)
