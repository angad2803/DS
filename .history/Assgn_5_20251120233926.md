# -----------------------------------------------

# UCS 548 – Foundations of Data Science

# Assignment 5 – Data Cleaning in R

# -----------------------------------------------

library(dplyr)

# ------------------------------------------------

# Q1. Read the CSV file & print first 10 records

# ------------------------------------------------

url <- "https://raw.githubusercontent.com/fivethirtyeight/data/master/daily-show-guests/daily_show_guests.csv"
df <- read.csv(url)

head(df, 10)

# ------------------------------------------------

# Q2. Display column names & rename the columns

# year → YEAR

# job → GoogleKnowlege_Occupation

# date → Show

# category → Group

# guest_name → Raw_Guest_List

# ------------------------------------------------

colnames(df)

df <- df %>%
rename(
YEAR = year,
GoogleKnowlege_Occupation = job,
Show = date,
Group = category,
Raw_Guest_List = guest_name
)

head(df)

# ------------------------------------------------

# Q3. Create a report having YEAR, Show, Raw_Guest_List

# ------------------------------------------------

report <- df %>%
select(YEAR, Show, Raw_Guest_List)

head(report)

# ------------------------------------------------

# Q4. Use select() to print all records EXCEPT YEAR

# ------------------------------------------------

df_without_year <- df %>%
select(-YEAR)

head(df_without_year)

# ------------------------------------------------

# Q5. Extract list of people who are “actor” and name is “ABC”

# ------------------------------------------------

actor_ABC <- df %>%
filter(GoogleKnowlege_Occupation == "actor" &
Raw_Guest_List == "ABC")

actor_ABC

# ------------------------------------------------

# Q6. Arrange records in order of Show (date)

# ------------------------------------------------

df_sorted <- df %>%
arrange(Show)

head(df_sorted)

# ------------------------------------------------

# Q7. Add a new column “Experience” using mutate()

# Experience = YEAR - 1990 (example formula)

# ------------------------------------------------

df <- df %>%
mutate(Experience = YEAR - 1990)

head(df)
